Homework_week_1

1: 
- docker run --help, found --rm for Automatically remove the container when it exits

2: 
- docker run -it --entrypoint=bash python:3.9
- pip list
- wheel      0.42.0


Preparing Postgres

- docker run -it \
    -e POSTGRES_USER="root" \
    -e POSTGRES_PASSWORD="root" \
    -e POSTGRES_DB="ny_taxi" \
    -v $(pwd)/ny_taxi_postgres_data:/var/lib/postgresql/data \
    -p 5432:5432 \
postgres:13

- pgcli -h localhost -p 5432 -u root -d ny_taxi

- jupyter notebook

- SELECT count(1)
 FROM 
 WHERE lpep_pickup_datetime::date = '2019-09-18'
 AND lpep_dropoff_datetime::date = '2019-09-18';

- SELECT lpep_pickup_datetime::date AS date, 
       max(trip_distance) AS largest_distance
FROM yellow_taxi_data
GROUP BY 1
ORDER BY 2 DESC
LIMIT 1;

- SELECT passenger_count, COUNT(1) AS trip_count
FROM yellow_taxi_data
WHERE lpep_pickup_datetime::date = '2019-01-01'
GROUP BY 1
HAVING passenger_count in (2, 3);

SELECT pickup."Borough" AS pickup_borough,
        SUM(total_amount) AS total_amount_sum
 FROM yellow_taxi_data AS taxi
 LEFT JOIN yellow_taxi_data_zones AS pickup ON taxi."PULocationID" = pickup."LocationID"
 LEFT JOIN yellow_taxi_data_zones AS dropoff ON taxi."DOLocationID" = dropoff."LocationID"
 WHERE lpep_pickup_datetime::date = '2019-09-18'
 GROUP BY 1
 ORDER BY total_amount_sum DESC LIMIT 5;

Borough


SELECT COALESCE(dropoff."Zone", 'Unknown') AS dropoff_zone,
       MAX(tip_amount) AS largest_tip
FROM yellow_taxi_data AS taxi
LEFT JOIN yellow_taxi_data_zones AS pickup ON taxi."PULocationID" = pickup."LocationID"
LEFT JOIN yellow_taxi_data_zones AS dropoff ON taxi."DOLocationID" = dropoff."LocationID"
WHERE pickup."Zone" = 'Astoria'
GROUP BY 1
ORDER BY largest_tip DESC
LIMIT 1;


